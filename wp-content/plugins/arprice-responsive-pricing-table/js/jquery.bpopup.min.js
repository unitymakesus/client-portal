!function(o){o.fn.bPopup=function(t,e){function n(){switch(b.contentContainer=o(b.contentContainer||U),b.content){case"iframe":var t=o('<iframe class="b-iframe" '+b.iframeAttr+"></iframe>");t.appendTo(b.contentContainer),P=U.outerHeight(!0),v=U.outerWidth(!0),i(),t.attr("src",b.loadUrl),p(b.loadCallback);break;case"image":i(),o("<img />").load(function(){p(b.loadCallback),l(o(this))}).attr("src",b.loadUrl).hide().appendTo(b.contentContainer);break;default:i(),o('<div class="b-ajax-wrapper"></div>').load(b.loadUrl,b.loadData,function(){p(b.loadCallback),l(o(this))}).hide().appendTo(b.contentContainer)}}function i(){b.modal&&o('<div class="b-modal '+w+'"></div>').css({backgroundColor:b.modalColor,position:"fixed",top:0,right:0,bottom:0,left:0,opacity:0,zIndex:b.zIndex+D}).appendTo(b.appendTo).fadeTo(b.speed,b.opacity),f(),U.data("bPopup",b).data("id",w).css({left:"slideIn"==b.transition||"slideBack"==b.transition?"slideBack"==b.transition?_.scrollLeft()+S:-1*(y+v):r(!(!b.follow[0]&&C||k)),position:b.positionStyle||"absolute",top:"slideDown"==b.transition||"slideUp"==b.transition?"slideUp"==b.transition?_.scrollTop()+I:T+-1*P:u(!(!b.follow[1]&&g||k)),"z-index":b.zIndex+D+1}).each(function(){b.appending&&o(this).appendTo(b.appendTo)}),d(!0)}function a(){return b.modal&&o(".b-modal."+U.data("id")).fadeTo(b.speed,0,function(){o(this).remove()}),b.scrollBar||o("html").css("overflow","auto"),o(".b-modal."+w).unbind("click"),_.unbind("keydown."+w),W.unbind("."+w).data("bPopup",0<W.data("bPopup")-1?W.data("bPopup")-1:null),U.undelegate(".bClose, ."+b.closeClass,"click."+w,a).data("bPopup",null),d(),!1}function l(o){var t=o.width(),e=o.height(),n={};b.contentContainer.css({height:e,width:t}),e>=U.height()&&(n.height=U.height()),t>=U.width()&&(n.width=U.width()),P=U.outerHeight(!0),v=U.outerWidth(!0),f(),b.contentContainer.css({height:"auto",width:"auto"}),n.left=r(!(!b.follow[0]&&C||k)),n.top=u(!(!b.follow[1]&&g||k)),U.animate(n,250,function(){o.show(),m=h()})}function s(){W.data("bPopup",D),U.delegate(".bClose, ."+b.closeClass,"click."+w,a),b.modalClose&&o(".b-modal."+w).css("cursor","pointer").bind("click",a),z||!b.follow[0]&&!b.follow[1]||W.bind("scroll."+w,function(){m&&U.dequeue().animate({left:b.follow[0]?r(!k):"auto",top:b.follow[1]?u(!k):"auto"},b.followSpeed,b.followEasing)}).bind("resize."+w,function(){I=H.innerHeight||W.height(),S=H.innerWidth||W.width(),(m=h())&&(clearTimeout(x),x=setTimeout(function(){f(),U.dequeue().each(function(){k?o(this).css({left:y,top:T}):o(this).animate({left:b.follow[0]?r(!0):"auto",top:b.follow[1]?u(!0):"auto"},b.followSpeed,b.followEasing)})},50))}),b.escClose&&_.bind("keydown."+w,function(o){27==o.which&&a()})}function d(o){function t(t){U.css({display:"block",opacity:1}).animate(t,b.speed,b.easing,function(){c(o)})}switch(o?b.transition:b.transitionClose||b.transition){case"slideIn":t({left:o?r(!(!b.follow[0]&&C||k)):_.scrollLeft()-(v||U.outerWidth(!0))-B});break;case"slideBack":t({left:o?r(!(!b.follow[0]&&C||k)):_.scrollLeft()+S+B});break;case"slideDown":t({top:o?u(!(!b.follow[1]&&g||k)):_.scrollTop()-(P||U.outerHeight(!0))-B});break;case"slideUp":t({top:o?u(!(!b.follow[1]&&g||k)):_.scrollTop()+I+B});break;default:U.stop().fadeTo(b.speed,o?1:0,function(){c(o)})}}function c(o){o?(s(),p(e),b.autoClose&&setTimeout(a,b.autoClose)):(U.hide(),p(b.onClose),b.loadUrl&&(b.contentContainer.empty(),U.css({height:"auto",width:"auto"})))}function r(o){return o?y+_.scrollLeft():y}function u(o){return o?T+_.scrollTop():T}function p(t){o.isFunction(t)&&t.call(U)}function f(){T=g?b.position[1]:Math.max(0,(I-U.outerHeight(!0))/2-b.amsl),y=C?b.position[0]:(S-U.outerWidth(!0))/2,m=h()}function h(){return I>U.outerHeight(!0)&&S>U.outerWidth(!0)}o.isFunction(t)&&(e=t,t=null);var b=o.extend({},o.fn.bPopup.defaults,t);b.scrollBar||o("html").css("overflow","hidden");var w,m,g,C,k,T,y,P,v,x,U=this,_=o(document),H=window,W=o(H),I=H.innerHeight||W.height(),S=H.innerWidth||W.width(),z=/OS 6(_\d)+/i.test(navigator.userAgent),B=200,D=0;return U.close=function(){b=this.data("bPopup"),w="__b-popup"+W.data("bPopup")+"__",a()},U.each(function(){o(this).data("bPopup")||(p(b.onOpen),D=(W.data("bPopup")||0)+1,w="__b-popup"+D+"__",g="auto"!==b.position[1],C="auto"!==b.position[0],k="fixed"===b.positionStyle,P=U.outerHeight(!0),v=U.outerWidth(!0),b.loadUrl?n():i())})},o.fn.bPopup.defaults={amsl:50,appending:!0,appendTo:"body",autoClose:!1,closeClass:"b-close",content:"ajax",contentContainer:!1,easing:"swing",escClose:!0,follow:[!0,!0],followEasing:"swing",followSpeed:500,iframeAttr:'scrolling="no" frameborder="0"',loadCallback:!1,loadData:!1,loadUrl:!1,modal:!0,modalClose:!0,modalColor:"#000",onClose:!1,onOpen:!1,opacity:.7,position:["auto","auto"],positionStyle:"absolute",scrollBar:!0,speed:250,transition:"fadeIn",transitionClose:!1,zIndex:999999}}(jQuery);